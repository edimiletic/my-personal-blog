<%- include("partials/header.ejs") %>
<%- include("partials/hero.ejs") %>
<div class="container  py-5">
    <% if(locals.cnt == 0){ %>
        <!-- Empty State -->
        <div class="row justify-content-center">
            <div class="col-md-8 text-center">
                <h2 class="mb-4">You haven't created any posts yet</h2>
                <p class="text-muted mb-5">Start sharing your thoughts!</p>
                <a href="/write-post" class="btn btn-primary btn-lg">Create Your First Post</a>
            </div>
        </div>
    <% } else { %>
        <!-- Blog Posts Grid -->
        <div class="row mb-5">
            <div class="col-12">
                <h2 class="mb-4">Recent Posts</h2>
            </div>
        </div>
        
        <div class="row g-4">
            <% for(let i = 0; i < Titles.length; i++){ %>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 shadow-sm post-card">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">
                                <a class="post-title text-decoration-none" href="#" data-title="<%= Titles[i] %>">
                                    <%= Titles[i] %>
                                </a>
                            </h5>
                            <p class="card-text text-muted flex-grow-1">
                                <%= Posts[i].substring(0, 120) %><%= Posts[i].length > 120 ? '...' : '' %>
                            </p>

                        </div>
                        <div class="card-footer d-flex flex-column bg-transparent border-top-0">
                                <a href="#" class="btn btn-outline-primary btn-sm mt-auto post-title" data-title="<%= Titles[i] %>">
                                Read More â†’
                            </a>
                        </div>
                    </div>
                </div>
            <% } %>
        </div>
    <% } %>
</div>

<!-- Include jQuery from CDN -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
    $(document).ready(function() {
        $('.post-title').click(function(e) {
            e.preventDefault();
            var titleText = $(this).data('title');
            window.location.href = '/details/' + encodeURIComponent(titleText);
        });
    });
</script>

<%- include("partials/footer.ejs") %>